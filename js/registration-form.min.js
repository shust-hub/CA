jQuery(document).ready(function(a){let stateActive=function(){let isState=a("#pb_country  option:selected").data("state");a("#pb_state").prop("disabled",!isState)};let bindRegForm=function(){stateActive();a("#pb_country").change(function(){stateActive()});a(".formLogIn").find("input, textarea").on("keyup blur focus",function(d){var c=a(this),b=c.prev("label");if(d.type==="keyup"){if(c.val()===""){b.removeClass("active highlight")}else{b.addClass("active highlight")}}else{if(d.type==="blur"){if(c.val()===""){b.removeClass("active highlight")}else{b.removeClass("highlight")}}else{if(d.type==="focus"){if(c.val()===""){b.removeClass("highlight")}else{if(c.val()!==""){b.addClass("highlight")}}}}}});a(".top-areaTab a").on("click",function(b){b.preventDefault();a(this).parent().addClass("active");a(this).parent().siblings().removeClass("active");target=a(this).attr("href");a(".tab-content > div").not(target).hide();a(target).fadeIn(600)});a(".previouslyRegistered").change(function(){var b=this.selectedIndex;var c=a(this).parents(".well");if(b!=""){c.find(".studentInfo").hide("slow");c.find(".student-info").prop("disabled",true);c.find(".studentCurrentInfo").show("slow");c.find(".studentCurrentInfo select").prop("disabled",false);c.find(".studentCurrentInfo .student-current-grade").val(a(this).find("option:selected").data("grade"))}else{c.find(".studentInfo").show("slow");c.find(".student-info").prop("disabled",false);c.find(".studentCurrentInfo").hide("slow");c.find(".studentCurrentInfo select").prop("disabled",true)}});a(".grades-check").change(function(){let out=a(this.options[this.selectedIndex]).data("out");if(out===true){let textMessage="This class is recommended for students in grades "+a(this).data("grades")+".  We suggest that you register your child in a class more suitable for his or her grade.";Swal.fire({html:textMessage,width:600,icon:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",confirmButtonText:"Browse Classes",cancelButtonText:"Dismiss"}).then(function(b){if(b.value){window.location.href="/online-coding-classes-for-kids"}})}});a("#forgotPwd").click(function(b){b.preventDefault();let email=a("input[name=login]").val();getOTP(email)});a("#signupForm").submit(function(b){b.preventDefault();let frm=a(this);let er=false;frm.find("input:required, select:required").each(function(){if(this.value.length<1){er="Please fill in all required fields!"}});if(!isValidEmail(a(frm).find('input[name="sign-up-email"]').val())){er="Please check your email address"}if(er){Swal.fire("Required fields!",er,"error")}else{a("#signupMsg").empty();a('<div class="loading">').appendTo(a("#registrationFormBlock"));a.ajax({type:"post",url:"/auth/signup",dataType:"json",data:frm.serialize(),success:function(c){if(c.error){a("#signupMsg").html(c.error);a(".loading").remove()}else{loadStudentForm()}}})}});a("#loginForm").submit(function(b){b.preventDefault();let frm=a(this);let er=false;frm.find("input:required, select:required").each(function(){if(this.value.length<1){er="Please fill in all required fields!"}});if(!isValidEmail(a(frm).find('input[name="login"]').val())){er="Please check your email address"}if(er){Swal.fire("Required fields!",er,"error")}else{a("#loginMsg").empty();a('<div class="loading">').appendTo(a("#registrationFormBlock"));a.ajax({type:"post",url:"/auth/login",dataType:"json",data:frm.serialize(),success:function(c){if(c.error){a("#loginMsg").html(c.error);a(".loading").remove()}else{loadStudentForm()}}})}})};a("#checkPromo").click(function(){var b=a("#pb_promo_code").val();a("#pmsg").html("");a.ajax({type:"get",url:"/promo-validator",dataType:"json",data:a("#orderForm").serialize(),success:function(c){if(c.price){var d=0;c.price.forEach(function(g,f,e){var h=a(".pcost")[f];d+=g.price;if(g.discount){a(h).parent("span").css({color:"#CCC","text-decoration":"line-through"});if(g.price){a(h).parents(".order-program-block").find(".dcost").html(" $"+g.price).css({color:"#F00"})}else{a(h).parents(".order-program-block").find(".dcost").html(" FREE").css({color:"#F00"})}}else{a(h).parent("span").css({color:"inherit","text-decoration":"none"})}});if(d){a("#ptotal").text("$"+d)}else{a("#ptotal").text("FREE")}}else{if(c.discount){let d=0;a(".pcost").each(function(){let orig=a(this).text();let np=orig;if(c.fix){np=orig-c.fix}else{np=Math.round(orig*((100-c.discount)/100))}if(np<0){np=0}a(this).parent("span").css({color:"#CCC","text-decoration":"line-through"});if(np){a(this).parents(".order-program-block").find(".dcost").html(" $"+np).css({color:"#F00"})}else{a(this).parents(".order-program-block").find(".dcost").html(" FREE").css({color:"#F00"})}d+=np});if(d){a("#ptotal").text("$"+d)}else{a("#ptotal").text("FREE")}}else{a(".pcost").parent("span").css({color:"inherit","text-decoration":"none"});let d=0;a(".pcost").each(function(){d+=a(this).text()*1});a("#ptotal").text("$"+d);a(".dcost").html("");if(c.error){a("#pmsg").css({color:"red"}).html(c.error)}else{if(b){a("#pmsg").html("Please enter a valid promo code")}}}}if(c.error){a("#pmsg").css({color:"red"}).html(c.error)}}})});let gtag_report_conversion=function(b){return false};let isValidEmail=function(c){var e=c.trim();var d=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);var b=d.test(e);return(b)};a("#registrationFormBlock").on("click",".go-to-log-in",function(b){b.preventDefault();a("#logInTab").click()}).on("click",".get-one-time-password",function(b){b.preventDefault();let email=a("input[name=sign-up-email]").val();console.log(email);getOTP(email)}).on("click","#submitRegistration",function(b){b.preventDefault();let frm=a(this).parents("form").css({position:"relative"});let er=false;a(frm).find("input:required:not(:disabled), select:required:not(:disabled)").each(function(){if(this.value.length<1){er="Please fill in all required fields!"}});if(!isValidEmail(a(frm).find('input[name="email"]').val())){er="Please check your email address"}if(!er&&a(frm).find('input[name="agree"]').prop("checked")==false){er="Please read and accept Terms and Conditions!"}if(!er&&a(frm).find('input[name="program-accept"]:not(:checked)').length){er="Please accept all the terms"}if(er){Swal.fire("Required fields!",er,"error")}else{if(typeof localStorage.cart!=="undefined"){localStorage.removeItem("cart")}gtag_report_conversion();a("#reg_promo_code").val(a("#pb_promo_code").val());a('<div class="loading">').appendTo(a("#registrationFormBlock"));a.ajax({type:"post",url:"/checkout-proceed",dataType:"html",data:a(frm).serialize(),success:function(c){a(".registration-info-block").remove();a("#registrationFormBlock").html(c);a("#payform_proceed").submit()}})}});a(".pb-students").change(function(){let cnt=a(this).val();if(!cnt){a(this).val("1");cnt=1;let progField=a(this).prop("id").replace("students","program");let $frm=a(this).parents("form");if(a(".pb-students").length>1){Swal.fire({html:"Do you really want to remove this course? ",width:600,icon:"question",showCancelButton:true,confirmButtonColor:"#3085d6",confirmButtonText:"Yes",reverseButtons:true}).then(function(b){if(b.value){let pnm=$frm.find("#"+progField).val();if(typeof localStorage.cart!=="undefined"){let classesInCart=JSON.parse(localStorage.getItem("cart"));classesInCart.forEach(function(e,d,c){if(e.id===pnm){classesInCart.splice(d,1)}});localStorage.setItem("cart",JSON.stringify(classesInCart))}let idsCart=[];$frm.find("input[name*=program]").each(function(c){if(a(this).val()!==pnm){idsCart.push(a(this).val())}});window.location.href="/online-registration?id="+idsCart.join("-")}})}else{Swal.fire("","Please choose the number of students","error")}}let $prog=a(this).parents(".order-program-block");let costElm=$prog.find(".pcost");let cost=costElm.data("cost")*cnt;costElm.text(cost);let total=0;a(".pcost").each(function(){total+=a(this).text()*1});a("#ptotal").text("$"+total);a("#checkPromo").click();if(a("#submitRegistration")[0]){loadStudentForm()}});let getOTP=function(b){Swal.fire({title:"Password assistance",html:"<p>Enter the email address associated with your CodeAdvantage account.</p>",input:"text",inputValue:b,inputAttributes:{placeholder:"Email"},allowOutsideClick:false,showCancelButton:true,confirmButtonText:"Continue",showLoaderOnConfirm:true,preConfirm:function(c){return fetch("/password/get-one-time?email="+c).then(function(d){return d.json()}).then(function(d){if(!d.ok){Swal.showValidationMessage(d.error)}return d})}}).then(function(c){if(c.value){loginOTP(c.value.email)}})};let loginOTP=function(b){Swal.fire({title:"Authentication required",html:"<p>For your security, we need to authenticate your request. We've sent a One Time Password (OTP) to the email "+b+". Please enter it below. </p>",input:"text",inputAttributes:{placeholder:"Enter OTP"},allowOutsideClick:false,showCancelButton:true,confirmButtonText:"Continue",showLoaderOnConfirm:true,preConfirm:function(c){return fetch("/auth/one-time?email="+b+"&otp="+c).then(function(d){return d.json()}).then(function(d){if(!d.ok){Swal.showValidationMessage(d.error)}return d})}}).then(function(c){if(c.value){loadStudentForm()}})};let loadStudentForm=function(){a('<div class="loading">').appendTo(a("#registrationFormBlock"));a.ajax({type:"post",url:"/registration-form",dataType:"html",data:a("#orderForm").serialize(),success:function(b){a("#registrationFormBlock").html(b);bindRegForm()}})};loadStudentForm()});